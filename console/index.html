<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <script src="RICv2.js"></script>
        
    </head>
    <body>
      <div id="output"></div>
      <script>
        let output = document.querySelector("#output");

        let callback = (version,src,dst,tags,data)=>{
            let newEntry = document.createElement("div");
            
            let datetime = new Date();
            let time = `${datetime.getHours() < 10 ? "0" : ""}${datetime.getHours()}:${datetime.getMinutes() < 10 ? "0" : ""}${datetime.getMinutes()}:${datetime.getSeconds() < 10 ? "0" : ""}${datetime.getSeconds() + datetime.getMilliseconds()/1000}`;

            if (tags & 1 != 0) {
                //Conntected new
                let snooping_enabled = tags & 2 != 0;

                newEntry.classList.add("disconncted");
                newEntry.innerHTML = `
                    <div class="version">v${version}</div>
                    <div class="time">${time}</div>
                    <div class="who">${src}</div>
                    <div class="message">Connected ${snooping_enabled ? "(can snoop)" : ""}</div>
                    `;
            } else if (tags & 128 != 0) {
                //Disconnected

                newEntry.classList.add("disconncted");
                newEntry.innerHTML = `
                    <div class="version">v${version}</div>
                    <div class="time">${time}</div>
                    <div class="who">${src}</div>
                    <div class="message">Disconnected</div>
                    `;
            } else {
                //Message

                newEntry.classList.add("message");
                newEntry.innerHTML = `
                    <div class="version">v${version}</div>
                    <div class="time">${time}</div>
                    <div class="who">Message from ${src} to ${dst}</div>
                    <div class="message">${data}</div>
                    `;
            }

            
            output.appendChild(newEntry);
        };
        let ric = new RobotikInterConnect(0,callback,"/",8080);
        
      </script>
    </body>
</html>